# 用戶旅程-測試案例映射

**專案**：鴿子競賽 GPS 追蹤系統
**最後更新**：2025-11-18
**版本**：1.0

---

## 📖 目的

本文檔將用戶旅程的每個步驟映射到對應的測試案例，確保：
- **完整測試覆蓋**：每個用戶操作步驟都有對應測試
- **優先級對齊**：測試優先級與用戶旅程重要性一致
- **缺漏識別**：發現未被測試覆蓋的用戶場景
- **測試追溯**：快速找到某個功能的所有相關測試

---

## 🎯 旅程 1：查看比賽軌跡和成績（核心旅程）

### 映射總覽

**用戶旅程來源**：[USER_JOURNEYS.md - 旅程1](../user-research/USER_JOURNEYS.md#旅程-1查看比賽軌跡和成績核心旅程)

**涵蓋測試案例數量**：27 個
**測試優先級分布**：P0 (15), P1 (9), P2 (3)
**預估測試時間**：15-20 分鐘

---

### 詳細步驟映射表

| 步驟 | 用戶操作 | 對應測試案例 | 優先級 | 測試文件 | 驗證重點 |
|------|---------|-------------|--------|---------|---------|
| **步驟1** | 進入網站首頁 | TC-01-001 | P1 | race-list.spec.ts | 頁面載入、標題、卡片顯示 |
| **步驟2** | 瀏覽賽事列表 | TC-01-002<br/>TC-01-003<br/>TC-01-005 | P1<br/>P1<br/>P2 | race-list.spec.ts | 搜尋功能<br/>年份篩選<br/>卡片資訊完整性 |
| **步驟3** | 找到目標賽事 | *(包含在 TC-01-002/003 中)* | - | - | - |
| **步驟4** | 點擊「進入」查看賽事詳情 | TC-01-004 | P1 | race-list.spec.ts | 按鈕可點擊、頁面跳轉、表格顯示 |
| **步驟5** | 在鴿子列表中找到自己的鴿子 | *(包含在 TC-02-001 中)* | - | - | - |
| **步驟6** | 選擇鴿子（勾選 checkbox） | TC-02-001 | **P0** | track-2d-static.spec.ts | checkbox 可勾選<br/>勾選清單計數<br/>按鈕啟用 |
| **步驟7** | 確認模式按鈕文字 ⚠️ | **TC-03-008** | **P0** | track-2d-playback.spec.ts | **按鈕文字判斷**<br/>**模式進入邏輯** |
| **步驟8** | 點擊「查看軌跡」按鈕 | TC-02-001<br/>TC-04-001 | **P0**<br/>**P0** | track-2d-static.spec.ts<br/>track-3d-playback.spec.ts | 按鈕響應<br/>軌跡視圖載入 |
| **步驟9** | 等待軌跡載入 | TC-02-002<br/>TC-02-006<br/>TC-04-001 | **P0**<br/>P1<br/>**P0** | track-2d-static.spec.ts<br/>track-2d-static.spec.ts<br/>track-3d-playback.spec.ts | 2D 切換順序<br/>API 調用驗證<br/>3D 初始化 |
| **步驟10a** | 查看 2D 軌跡 | TC-02-003<br/>TC-02-005<br/>TC-03-001~007 | **P0**<br/>P1<br/>**P0** | track-2d-static.spec.ts<br/>track-2d-static.spec.ts<br/>track-2d-playback.spec.ts | 靜態模式確認<br/>軌跡線渲染<br/>動態播放功能 |
| **步驟10b** | 查看 3D 軌跡 | TC-04-001~006 | **P0** | track-3d-playback.spec.ts | 3D 地球渲染<br/>視角切換<br/>標記點顯示 |
| **步驟11** | 互動分析飛行數據 | TC-02-004<br/>TC-06-001~004<br/>TC-07-001~006 | **P0**<br/>P1<br/>P2 | track-2d-static.spec.ts<br/>trajectory-detail.spec.ts<br/>ui-elements.spec.ts | 軌跡點點擊<br/>詳細資訊顯示<br/>UI 元素互動 |

---

### 關鍵路徑測試覆蓋

**關鍵路徑**（最常用的操作序列）：
```
步驟1 → 步驟3 → 步驟4 → 步驟6 → 步驟7 → 步驟8 → 步驟10 → 步驟11
```

**對應 P0 測試案例**（必須全部通過）：
- TC-02-001: 選擇鴿子並查看軌跡
- **TC-03-008: 模式按鈕邏輯驗證** ⭐ **最關鍵**
- TC-02-002: 切換到 2D 模式
- TC-02-003: 確保靜態模式
- TC-02-004: 點擊軌跡點查看資訊
- TC-04-001~006: 3D 模式完整測試

**覆蓋率**：100% ✅

---

### 決策點測試覆蓋

#### 決策點 1：模式按鈕文字判斷（最關鍵）

| 分支 | 條件 | 對應測試案例 | 優先級 |
|------|------|-------------|--------|
| 進入 2D 模式 | 按鈕顯示「2D」 | TC-03-008（分支A） | **P0** |
| 進入 3D 模式 | 按鈕顯示「3D」 | TC-03-008（分支B）<br/>TC-04-001 | **P0** |

**覆蓋率**：100% ✅

---

#### 決策點 2：單只 vs 多只鴿子

| 分支 | 條件 | 對應測試案例 | 優先級 |
|------|------|-------------|--------|
| 單只鴿子 | 勾選 1 只 | TC-02-001 | **P0** |
| 多只鴿子 | 勾選 2+ 只 | **缺少專門測試** ⚠️ | P1 |

**覆蓋率**：50% ⚠️ **需補充多鴿比較測試**

---

#### 決策點 3：靜態 vs 動態模式（2D 中）

| 分支 | 條件 | 對應測試案例 | 優先級 |
|------|------|-------------|--------|
| 靜態模式 | 標記點 ≥15 個 | TC-02-003 | **P0** |
| 動態模式 | 標記點 1-3 個 | TC-03-001 | **P0** |
| 切換互動 | timeline 按鈕 | TC-03-002~007 | **P0** |

**覆蓋率**：100% ✅

---

#### 決策點 4：使用搜尋/篩選（步驟2）

| 分支 | 條件 | 對應測試案例 | 優先級 |
|------|------|-------------|--------|
| 直接瀏覽 | 不使用搜尋 | TC-01-001 | P1 |
| 搜尋功能 | 輸入關鍵字 | TC-01-002 | P1 |
| 年份篩選 | 選擇年份 | TC-01-003 | P1 |

**覆蓋率**：100% ✅

---

### 錯誤處理測試覆蓋

| 可能問題 | 出現階段 | 對應測試案例 | 優先級 | 狀態 |
|---------|----------|-------------|--------|------|
| 2D 軌跡初次載入失敗 | 步驟9 | TC-02-002 | **P0** | ✅ 已覆蓋 |
| 靜態/動態模式混淆 | 步驟10 | TC-02-003, TC-03-001 | **P0** | ✅ 已覆蓋 |
| 軌跡點點擊無響應 | 步驟11 | TC-02-004, TC-06-001 | **P0/P1** | ✅ 已覆蓋 |
| 數據載入時機不明確 | 步驟9 | TC-02-006 | P1 | ✅ 已覆蓋 |
| API 調用失敗 | 步驟8-9 | TC-02-006 | P1 | ⚠️ 部分覆蓋 |
| 找不到目標鴿子 | 步驟5 | **缺少測試** | P2 | ❌ 未覆蓋 |

**覆蓋率**：80% ⚠️ **需補充邊緣案例測試**

---

### 測試優先級分布（旅程1）

| 優先級 | 測試數量 | 占比 | 預估時間 |
|--------|---------|------|---------|
| **P0** | 15 | 56% | 10 min |
| **P1** | 9 | 33% | 5 min |
| **P2** | 3 | 11% | 3 min |
| **總計** | **27** | **100%** | **18 min** |

---

## 🎯 旅程 2：管理鴿舍資訊

### 映射總覽

**用戶旅程來源**：[USER_JOURNEYS.md - 旅程2](../user-research/USER_JOURNEYS.md#旅程-2管理鴿舍資訊)

**涵蓋測試案例數量**：4 個
**測試優先級分布**：P1 (4)
**預估測試時間**：3 分鐘

---

### 詳細步驟映射表

| 步驟 | 用戶操作 | 對應測試案例 | 優先級 | 測試文件 | 驗證重點 |
|------|---------|-------------|--------|---------|---------|
| **步驟1** | 從賽事詳情頁進入 | *(依賴旅程1步驟1-4)* | - | - | - |
| **步驟2** | 切換到「鴿舍列表」標籤 | TC-05-001 | P1 | loft-list.spec.ts | 標籤切換、列表顯示 |
| **步驟3** | 查看或搜尋自己的鴿舍 | TC-05-002 | P1 | loft-list.spec.ts | 搜尋功能 |
| **步驟4** | 選擇鴿舍 | *(包含在 TC-05-003 中)* | - | - | - |
| **步驟5** | 查看鴿舍內所有鴿子 | TC-05-003 | P1 | loft-list.spec.ts | 鴿舍鴿子列表 |
| **步驟6** | 選擇特定鴿子查看軌跡 | TC-05-004 | P1 | loft-list.spec.ts | 從鴿舍進入軌跡 |

---

### 關鍵路徑測試覆蓋

**關鍵路徑**：
```
步驟1 → 步驟2 → 步驟3 → 步驟5
```

**對應測試案例**：
- TC-05-001: 切換標籤
- TC-05-002: 搜尋鴿舍
- TC-05-003: 查看鴿舍鴿子

**覆蓋率**：100% ✅

---

### 決策點測試覆蓋

#### 決策點：使用搜尋 vs 滾動列表

| 分支 | 條件 | 對應測試案例 | 優先級 |
|------|------|-------------|--------|
| 使用搜尋 | 鴿舍很多 | TC-05-002 | P1 |
| 滾動列表 | 鴿舍不多 | TC-05-001 | P1 |

**覆蓋率**：100% ✅

---

## 🎯 旅程 3：賽後深度分析（進階用戶）

### 映射總覽

**用戶旅程來源**：[USER_JOURNEYS.md - 旅程3](../user-research/USER_JOURNEYS.md#旅程-3賽後深度分析)

**涵蓋測試案例數量**：17 個
**測試優先級分布**：P0 (6), P1 (5), P2 (6)
**預估測試時間**：12 分鐘

---

### 關鍵操作映射表

| 操作類型 | 對應測試案例 | 優先級 | 測試文件 |
|---------|-------------|--------|---------|
| **多只鴿子比較** | **缺少專門測試** ⚠️ | P1 | - |
| **2D/3D 視圖切換** | TC-03-008<br/>TC-04-004 | **P0**<br/>P1 | track-2d-playback.spec.ts<br/>track-3d-playback.spec.ts |
| **軌跡點詳細數據分析** | TC-06-001~004 | P1 | trajectory-detail.spec.ts |
| **靜態/動態播放切換** | TC-03-001~007 | **P0** | track-2d-playback.spec.ts |
| **3D 視角切換** | TC-04-002~003 | P1 | track-3d-playback.spec.ts |

---

## 📊 測試覆蓋率總結

### 按旅程分類

| 用戶旅程 | 涵蓋測試數 | P0 | P1 | P2 | 覆蓋率 | 缺漏數 |
|---------|-----------|----|----|----|----|-------|
| 旅程1: 查看比賽軌跡 | 27 | 15 | 9 | 3 | 95% | 2 ⚠️ |
| 旅程2: 管理鴿舍 | 4 | 0 | 4 | 0 | 100% | 0 ✅ |
| 旅程3: 深度分析 | 17 | 6 | 5 | 6 | 85% | 3 ⚠️ |
| **總計** | **48** | **21** | **18** | **9** | **93%** | **5** |

---

### 按測試優先級分類

| 優先級 | 測試數量 | 旅程覆蓋 | 狀態 |
|--------|---------|---------|------|
| **P0** | 21 | 旅程1核心路徑 | ✅ 完整覆蓋 |
| **P1** | 18 | 旅程1+2+3 | ✅ 良好覆蓋 |
| **P2** | 9 | 旅程3進階功能 | ⚠️ 部分覆蓋 |

---

### 按功能模組分類

| 功能模組 | 對應旅程步驟 | 測試數量 | 覆蓋率 |
|---------|------------|---------|--------|
| 賽事列表 | 旅程1 步驟1-4 | 5 | 100% ✅ |
| 鴿子選擇 | 旅程1 步驟5-6 | 1 | 80% ⚠️ |
| **模式切換** | **旅程1 步驟7** | **1** | **100% ✅** |
| 2D 靜態軌跡 | 旅程1 步驟9-10 | 6 | 100% ✅ |
| 2D 動態播放 | 旅程1 步驟10 | 7 | 100% ✅ |
| 3D 模式 | 旅程1 步驟10 | 6 | 100% ✅ |
| 軌跡點互動 | 旅程1 步驟11 | 4 | 100% ✅ |
| 鴿舍管理 | 旅程2 全部 | 4 | 100% ✅ |
| UI 元素 | 旅程1 步驟11 | 6 | 80% ⚠️ |

---

## 🔍 缺漏分析

### 已識別的測試缺漏

#### 缺漏 1：多只鴿子同時比較
**影響旅程**：旅程1 步驟6（決策點）、旅程3

**當前狀態**：只測試單只鴿子選擇

**建議補充測試**：
- **TC-02-007**: 選擇多只鴿子（2-5只）
  - 優先級：P1
  - 驗證：多條軌跡同時顯示、顏色區分、圖例顯示
  - 預估時間：3 分鐘

---

#### 缺漏 2：環號搜尋功能
**影響旅程**：旅程1 步驟5

**當前狀態**：未測試搜尋功能

**建議補充測試**：
- **TC-01-006**: 鴿子環號搜尋
  - 優先級：P2
  - 驗證：搜尋框輸入、即時過濾、結果匹配
  - 預估時間：2 分鐘

---

#### 缺漏 3：API 錯誤處理
**影響旅程**：旅程1 步驟8-9

**當前狀態**：只驗證成功情況

**建議補充測試**：
- **TC-02-008**: API 調用失敗處理
  - 優先級：P1
  - 驗證：錯誤提示、重試機制、降級方案
  - 預估時間：3 分鐘

---

#### 缺漏 4：鴿舍資訊編輯
**影響旅程**：旅程2 步驟6（可選）

**當前狀態**：未測試編輯功能

**建議補充測試**：
- **TC-05-005**: 鴿舍資訊編輯（如果有權限）
  - 優先級：P2
  - 驗證：編輯表單、保存、權限檢查
  - 預估時間：4 分鐘

---

#### 缺漏 5：數據導出功能
**影響旅程**：旅程3（進階需求）

**當前狀態**：功能存在但未測試

**建議補充測試**：
- **TC-06-005**: 軌跡數據導出
  - 優先級：P2
  - 驗證：導出格式（CSV/Excel）、數據完整性
  - 預估時間：3 分鐘

---

### 補充測試優先級

| 缺漏測試 | 優先級 | 影響範圍 | 建議實作階段 |
|---------|--------|---------|-------------|
| TC-02-007: 多鴽比較 | P1 | 高 | Phase 2 |
| TC-02-008: API 錯誤處理 | P1 | 高 | Phase 2 |
| TC-01-006: 環號搜尋 | P2 | 中 | Phase 3 |
| TC-05-005: 鴿舍編輯 | P2 | 低 | Phase 3 |
| TC-06-005: 數據導出 | P2 | 低 | Phase 3 |

---

## 📈 覆蓋率改進建議

### 短期目標（Phase 2）
1. ✅ **保持 P0 測試 100% 覆蓋**（已達成）
2. ⚠️ **補充 P1 缺漏測試**（TC-02-007, TC-02-008）
3. 📊 **目標覆蓋率**：從 93% 提升至 97%

### 長期目標（Phase 3）
1. 補充 P2 測試（TC-01-006, TC-05-005, TC-06-005）
2. 增加邊緣案例測試
3. 添加性能測試
4. 📊 **目標覆蓋率**：達到 99%+

---

## 🔗 相關文檔

- [User Journeys](../user-research/USER_JOURNEYS.md) - 用戶旅程詳細描述
- [Test Cases](../test-plan/TEST_CASES.md) - 35+ 詳細測試案例
- [Feature Test Mapping](FEATURE_TEST_MAPPING.md) - 功能-測試映射
- [Test Plan Overview](../test-plan/TEST_PLAN_OVERVIEW.md) - 測試策略總覽

---

**文檔維護者**：專案團隊
**審核狀態**：初版
**下次審核日期**：Phase 2 實作完成後（更新實際覆蓋率）
